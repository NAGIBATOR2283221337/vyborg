# üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –î–∞—Ç–∞: 2025-11-13

## ‚ùå –û—à–∏–±–∫–∞:
```
Unknown format code 'd' for object of type 'float'
```

## üîç –ü—Ä–∏—á–∏–Ω–∞:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `{value:02d}` –¥–ª—è float –∑–Ω–∞—á–µ–Ω–∏–π –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ int.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. **parse_dt_key()** - —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–ª—é—á–∞ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
**–ë—ã–ª–æ:**
```python
d,t=full.split(" –≤ "); dd,mm,yyyy=d.split("."); h,m=t.split(":")
return (int(yyyy),int(mm),int(dd),int(h),int(m))
```

**–°—Ç–∞–ª–æ:**
```python
d, t = full.split(" –≤ ")
dd, mm, yyyy = d.split(".")
h, m = t.split(":")
return (int(yyyy), int(mm), int(dd), int(h), int(m))
```
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —è–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å

### 2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —Å—Ç—Ä–æ–∫–∏**
**–ë—ã–ª–æ:**
```python
logger.info(f"üìÖ –°—Ç—Ä–æ–∫–∞ {idx+1}: –ù–∞–π–¥–µ–Ω–∞ –¥–∞—Ç–∞...")
```

**–°—Ç–∞–ª–æ:**
```python
logger.info(f"üìÖ –°—Ç—Ä–æ–∫–∞ {int(idx)+1}: –ù–∞–π–¥–µ–Ω–∞ –¥–∞—Ç–∞...")
```
‚úÖ idx –∏–∑ pandas –º–æ–∂–µ—Ç –±—ã—Ç—å float, —Ç–µ–ø–µ—Ä—å —è–≤–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ int

### 3. **parse_time_from_str()** - —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
–î–æ–±–∞–≤–ª–µ–Ω–æ:
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–µ–ª >= 1.0 (–µ—Å–ª–∏ —á–∏—Å–ª–æ < 24, —Å—á–∏—Ç–∞–µ–º —á–∞—Å–∞–º–∏)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –≤–∏–¥–∞ "6.0" (–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–µ—Ä–µ–∑ float‚Üíint)
- ‚úÖ Try-except –±–ª–æ–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–∑–æ–≤ str(x)

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```python
parse_time_from_str(6.0)    ‚Üí "6:00"  # –ë—ã–ª–æ: –æ—à–∏–±–∫–∞
parse_time_from_str("6.0")  ‚Üí "6:00"  # –ë—ã–ª–æ: None
parse_time_from_str(12.5)   ‚Üí "12:00" # –ß–∏—Å–ª–æ –∫–∞–∫ —á–∞—Å
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python test_parsing.py
```

–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
```
‚úÖ –°—Ç—Ä–æ–∫–∞ HH:MM              ‚Üí 6:00
‚úÖ –°—Ç—Ä–æ–∫–∞ HH:MM:SS           ‚Üí 06:00
‚úÖ Excel —á–∏—Å–ª–æ 0.25 (6:00)   ‚Üí 6:00
‚úÖ Excel —á–∏—Å–ª–æ 0.5 (12:00)   ‚Üí 12:00
‚úÖ –ß–∏—Å–ª–æ 6 (6 —á–∞—Å–æ–≤)         ‚Üí 6:00
...
```

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `START_SERVER_DEBUG.bat`
2. –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
3. –û—à–∏–±–∫–∞ "Unknown format code 'd'" –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

- `backend/processors/shared.py`:
  - `parse_time_from_str()` - —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞
  - `parse_dt_key()` - —É–ª—É—á—à–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `build_schedule_index()` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ò–°–ü–†–ê–í–õ–ï–ù–û

–û—à–∏–±–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤.

