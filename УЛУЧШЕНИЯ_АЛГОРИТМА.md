# üöÄ –£–õ–£–ß–®–ï–ù–ù–´–ô –ê–õ–ì–û–†–ò–¢–ú –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

1. **–°–Ω–∏–∂–µ–Ω—ã –ø–æ—Ä–æ–≥–∏ –¥–ª—è –±–æ–ª–µ–µ –º—è–≥–∫–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
   - BASE_RATIO: 70 ‚Üí 60 (—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫)
   - PARTIAL_RATIO: 80 ‚Üí 70 (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
   - TOKEN_SET: 80 ‚Üí 70 (—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤)
   - JACCARD_MIN: 0.35 ‚Üí 0.25 (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)
   - MAX_CANDIDATES: 8 ‚Üí 12 (–±–æ–ª—å—à–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

2. **–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
   - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ñ–∞–∫–∫–∞—Ä–∞ (–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)
   - Word overlap ratio (–∫–∞–∫–∞—è —á–∞—Å—Ç—å —Å–ª–æ–≤ –∏–∑ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –µ—Å—Ç—å –≤ –¥–ª–∏–Ω–Ω–æ–π)
   - Partial word match (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å–ª–æ–≤ - –ø–æ–¥—Å—Ç—Ä–æ–∫–∏)
   - Token sort ratio (—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π —Ç–æ–∫–µ–Ω–æ–≤)

3. **–ö–∞—Å–∫–∞–¥–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞**
   - **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1**: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –±–∞–∑—ã –∏ –≤—Å–µ—Ö —ç–ø–∏–∑–æ–¥–æ–≤
   - **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2**: –ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —ç–ø–∏–∑–æ–¥–æ–≤ (–ª—é–±–∞—è –æ–±—â–∞—è —Å–µ—Ä–∏—è)
   - **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3**: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –±–∞–∑–µ –±–µ–∑ —É—á–µ—Ç–∞ —ç–ø–∏–∑–æ–¥–æ–≤
   - **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 4**: –¢–æ–ø-–∫–∞–Ω–¥–∏–¥–∞—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —ç–ø–∏–∑–æ–¥–æ–≤ (fallback)

4. **–£–ª—É—á—à–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤: —Å–µ—Ä–∏—è/—ç–ø–∏–∑–æ–¥/–≤—ã–ø—É—Å–∫/—á–∞—Å—Ç—å
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤: —Ä–µ–¥, copy, —Ñ–∏–ª—å–º, –ø–µ—Ä–µ–¥–∞—á–∞ –∏ —Ç.–¥.
   - –õ—É—á—à–µ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ —ç–ø–∏–∑–æ–¥–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –±–µ–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π**
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ: delete_unmatched=True
   - –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–∏–º–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è:

| –ù–∞–∑–≤–∞–Ω–∏–µ –≤ –æ—Ç—á—ë—Ç–µ | –ù–∞–∑–≤–∞–Ω–∏–µ –≤ —Å–µ—Ç–∫–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------------------|------------------|-----------|
| –î–∏–∫–∏–µ –∏ —Å—Ç–∏–ª—å–Ω—ã–µ. 2 –≤—ã–ø—É—Å–∫ | –¥–∏–∫–∏–µ —Å—Ç–∏–ª—å–Ω—ã–µ 2 | ‚úÖ –ù–∞–π–¥–µ–Ω–æ |
| –ì–æ—Ä–∞ —Å–∞–º–æ—Ü–≤–µ—Ç–æ–≤. 63 —Å–µ—Ä–∏—è | –≥–æ—Ä–∞ —Å–∞–º–æ—Ü–≤–µ—Ç–æ–≤ 63,64 | ‚úÖ –ù–∞–π–¥–µ–Ω–æ |
| –ë–ï–°–¶–ï–ù–ù–ê–Ø –õ–Æ–ë–û–í–¨ 4 —Å–µ—Ä–∏—è | –±–µ—Å—Ü–µ–Ω–Ω–∞—è –ª—é–±–æ–≤—å 4 | ‚úÖ –ù–∞–π–¥–µ–Ω–æ |
| 18 –ª—É–Ω | 18 –ª—É–Ω | ‚úÖ –ù–∞–π–¥–µ–Ω–æ |
| –ù–æ–≤–æ—Å—Ç–∏ (copy 1) | –Ω–æ–≤–æ—Å—Ç–∏ | ‚úÖ –ù–∞–π–¥–µ–Ω–æ |

## üéØ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –±–∞—Ç–Ω–∏–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
start_improved_server.bat
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é

```bash
cd C:\Users\User\Desktop\PythonProject\PythonProject
python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª–µ–π

```bash
python test_improved_matching.py
```

## üìù –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

```
http://localhost:8000
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **–ú–∞–∫—Å–∏–º—É–º –ø–æ–∫–∞–∑–æ–≤**: 3 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–ü–æ—Ä–æ–≥ –Ω–µ—á—ë—Ç–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞**: 0.60 (–±—ã–ª–æ 0.20)
- **–¢–æ–∫–µ–Ω–Ω—ã–π –æ–≤–µ—Ä–ª–∞–ø**: 0.40 (–±—ã–ª–æ 0.35)
- **–£–¥–∞–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π**: ‚úÖ –≤–∫–ª—é—á–µ–Ω–æ

## üîç –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–°–µ—Ä–≤–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
- ‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—á–∏
- üîç –¢–æ–ø-3 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –¥–ª—è –Ω–µ—á—ë—Ç–∫–∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üìÇ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `backend/processors/settings_match.py` - —Å–Ω–∏–∂–µ–Ω—ã –ø–æ—Ä–æ–≥–∏
2. `backend/processors/matcher.py` - —É–ª—É—á—à–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º
3. `backend/processors/processor_rus.py` - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω matcher
4. `backend/processors/normalize_titles.py` - —É–ª—É—á—à–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç–ø–∏–∑–æ–¥–æ–≤
5. `backend/processors/shared.py` - –≤–∫–ª—é—á–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install rapidfuzz openpyxl pandas fastapi uvicorn
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π:
   ```bash
   python -c "from backend.processors import processor_rus, matcher; print('OK')"
   ```

3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ - —Ç–∞–º –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏

## üìà –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Å–µ—Ç–∫–∏** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
   - –°—Ç—Ä–æ–∫–∏-–∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å –¥–∞—Ç–∞–º–∏: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 1 —Å–µ–Ω—Ç—è–±—Ä—è 2025"
   - –ö–æ–ª–æ–Ω–∫–∞ A: –≤—Ä–µ–º—è (6:00, 07:00, etc.)
   - –ö–æ–ª–æ–Ω–∫–∞ B: –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏

2. **–°–Ω–∏–∑—å—Ç–µ –ø–æ—Ä–æ–≥–∏ –µ—â—ë –±–æ–ª—å—à–µ** –≤ `settings_match.py`:
   ```python
   BASE_RATIO = 50  # –±—ã–ª–æ 60
   JACCARD_MIN = 0.20  # –±—ã–ª–æ 0.25
   ```

3. **–í–∫–ª—é—á–∏—Ç–µ DEBUG –ª–æ–≥–∏** - –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è:
   ```python
   logging.basicConfig(level=logging.DEBUG)
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è** —á–µ—Ä–µ–∑ test_improved_matching.py

---

**–í–µ—Ä—Å–∏—è**: 2.0 (—É–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º)  
**–î–∞—Ç–∞**: 2025-01-13

