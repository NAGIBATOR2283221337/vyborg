"""
Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ ÑÐ¾Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ
"""
import re

def normalize_base_improved(title: str) -> str:
    """Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð½Ð°Ñ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹"""
    if not title:
        return ""

    title = str(title).strip()

    # Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð½Ð¾Ð¼ÐµÑ€Ð° ÑÐµÑ€Ð¸Ð¹ Ð¸ ÑÐ¿Ð¸Ð·Ð¾Ð´Ð¾Ð²
    title = re.sub(r'\s+\d+[,\s]*\d*\s*', ' ', title)

    # Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð°Ñ€Ñ‚Ð¸ÐºÑƒÐ»Ñ‹ Ð¸ ÐºÐ¾Ð´Ñ‹ Ð² ÑÐºÐ¾Ð±ÐºÐ°Ñ…
    title = re.sub(r'\([^)]*\)', '', title)

    # Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÐ»ÑƒÐ¶ÐµÐ±Ð½Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°
    title = re.sub(r'\b(ÑÐµÑ€Ð¸Ñ|ÑÐµÑ€Ð¸Ð¸|Ð²Ñ‹Ð¿ÑƒÑÐº|Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð°|Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°|Ñ„Ð¸Ð»ÑŒÐ¼|ÐºÐ¾Ð¿Ð¸Ñ|copy)\b', '', title, flags=re.IGNORECASE)

    # ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð²
    title = re.sub(r'\s+', ' ', title).strip()

    return title.lower()

# Ð¢ÐµÑÑ‚ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
test_cases = [
    "Ð“Ð¾Ñ€Ð° ÑÐ°Ð¼Ð¾Ñ†Ð²ÐµÑ‚Ð¾Ð² 61, 62",
    "Ð—Ð°ÑÑ‚Ð°Ð²ÐºÐ° Ð¡ÐœÐ˜",
    "Ð—Ð°ÑÑ‚Ð°Ð²ÐºÐ° Ð”Ð¾Ð±Ñ€Ð¾Ðµ ÑƒÑ‚Ñ€Ð¾!",
    "Ð—Ð°ÑÑ‚Ð°Ð²ÐºÐ° Ð ÐµÐºÐ»Ð°Ð¼Ð°",
    "Ð ÐµÐºÐ»Ð°Ð¼Ð°",
    "ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€"
]

print("ðŸ” Ð¢Ð•Ð¡Ð¢ Ð£Ð›Ð£Ð§Ð¨Ð•ÐÐÐžÐ™ ÐÐžÐ ÐœÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð˜:")
for original in test_cases:
    normalized = normalize_base_improved(original)
    print(f"'{original}' -> '{normalized}'")
