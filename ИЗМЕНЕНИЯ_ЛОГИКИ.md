# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## –î–∞—Ç–∞: 2025-11-13

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏:

1. **"–ü—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç –¥–∞—Ç—ã"** - –ø–∞—Ä—Å–µ—Ä –∏—Å–∫–∞–ª –¥–∞—Ç—ã —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ç–æ—Ä–æ–π –∫–æ–ª–æ–Ω–∫–µ (B)
2. **–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç "–µ–ª–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"** - fuzzy matching –±—ã–ª —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º (–ø–æ—Ä–æ–≥–∏ 0.05 –∏ 0.10)
3. **–ñ—ë—Å—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –∫–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–ª A=–≤—Ä–µ–º—è, B=–Ω–∞–∑–≤–∞–Ω–∏–µ
4. **–ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. –ì–∏–±–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ —Å–µ—Ç–∫–∏ (`shared.py: build_schedule_index`)
- ‚úÖ –ò—â–µ—Ç –¥–∞—Ç—É –≤ **–õ–Æ–ë–û–ô –∫–æ–ª–æ–Ω–∫–µ** (–Ω–µ —Ç–æ–ª—å–∫–æ B)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç:
  - "1 —Å–µ–Ω—Ç—è–±—Ä—è 2025"
  - "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 1 —Å–µ–Ω—Ç—è–±—Ä—è 2025"  
  - "01.09.2025"
  - "01.09.25"
- ‚úÖ –ü—Ä–æ–±—É–µ—Ç –æ–±–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: A=–≤—Ä–µ–º—è B=–Ω–∞–∑–≤–∞–Ω–∏–µ –ò–õ–ò B=–≤—Ä–µ–º—è A=–Ω–∞–∑–≤–∞–Ω–∏–µ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ (`shared.py: parse_time_from_str`)
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç Excel —á–∏—Å–ª–∞ (0.25 = 06:00)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç pandas Timestamp –∏ datetime
- ‚úÖ –§–æ—Ä–º–∞—Ç—ã: "6:00", "06:00", "6:00:00"
- ‚úÖ –û–¥–∏–Ω–æ—á–Ω–æ–µ —á–∏—Å–ª–æ —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å ("6" ‚Üí "6:00")

### 3. –†–∞–∑—É–º–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ fuzzy matching

**–ë—ã–ª–æ:**
- `fuzzy_cutoff = 0.05` (5% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ - —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ!)
- `min_token_overlap = 0.10` (10% –æ–±—â–∏—Ö —Å–ª–æ–≤ - —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ!)
- `delete_unmatched = True` (–æ–ø–∞—Å–Ω–æ!)

**–°—Ç–∞–ª–æ:**
- `fuzzy_cutoff = 0.70` (70% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫)
- `min_token_overlap = 0.50` (50% –æ–±—â–∏—Ö —Å–ª–æ–≤)
- `delete_unmatched = False` (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`processor_rus.py`)
–¢–µ–ø–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω–æ:
```
INFO: üöÄ –ù–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: max_shows=3, fuzzy_cutoff=0.70, min_token_overlap=0.50
INFO: üìñ –°—Ç—Ä–æ—é –∏–Ω–¥–µ–∫—Å —Å–µ—Ç–∫–∏...
INFO: üìñ –ß–∏—Ç–∞—é –ª–∏—Å—Ç: –õ–∏—Å—Ç1
INFO: üìè –†–∞–∑–º–µ—Ä: 1234 —Å—Ç—Ä–æ–∫ √ó 5 –∫–æ–ª–æ–Ω–æ–∫
INFO: üìÖ –°—Ç—Ä–æ–∫–∞ 5: –ù–∞–π–¥–µ–Ω–∞ –¥–∞—Ç–∞ '01.09.2025' –≤ –∫–æ–ª–æ–Ω–∫–µ 1
INFO: üìÖ –°—Ç—Ä–æ–∫–∞ 15: –ù–∞–π–¥–µ–Ω–∞ –¥–∞—Ç–∞ '02.09.2025' –≤ –∫–æ–ª–æ–Ω–∫–µ 1
INFO: ‚úÖ –ù–∞–π–¥–µ–Ω–æ –¥–∞—Ç: 30, –ø—Ä–æ–≥—Ä–∞–º–º: 850
INFO: üìä –ò–Ω–¥–µ–∫—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω: 30 –¥–∞—Ç, 850 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
INFO: üìÑ –ó–∞–≥—Ä—É–∂–∞—é –æ—Ç—á—ë—Ç...
INFO: üìç –ó–∞–≥–æ–ª–æ–≤–∫–∏: —Å—Ç—Ä–æ–∫–∞ 12, –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ 2, –¥–∞—Ç—ã –≤ –∫–æ–ª–æ–Ω–∫–µ 8
INFO: ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: 145 —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, 5 –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–∑ 150 —Å—Ç—Ä–æ–∫
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `START_SERVER.bat` –∏ –æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã.
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

1. **–†–æ—Å—Å–∏–π—Å–∫–∏–π –æ—Ç—á–µ—Ç**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞—Ç—ã –∏–∑ —Å–µ—Ç–∫–∏ (–Ω–µ "–ø—Ä–∏–¥—É–º–∞–Ω–Ω—ã–µ")
2. **–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç**: –ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, —Ç–æ—á–Ω–µ–µ –º–∞—Ç—á–∏–Ω–≥
3. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –í–∏–¥–Ω–æ, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º –Ω–∞–π–¥–µ–Ω–æ, —Å–∫–æ–ª—å–∫–æ –¥–∞—Ç –∏–∑–≤–ª–µ—á–µ–Ω–æ

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∏—Å–∫ –±–æ–ª–µ–µ/–º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏–º, –∏–∑–º–µ–Ω–∏—Ç–µ –≤ UI:

- **–ü–æ—Ä–æ–≥ –Ω–µ—á—ë—Ç–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞**: 0.70 (—á–µ–º –≤—ã—à–µ - —Ç–µ–º —Å—Ç—Ä–æ–∂–µ)
- **–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤**: 0.50 (—á–µ–º –≤—ã—à–µ - —Ç–µ–º —Å—Ç—Ä–æ–∂–µ)

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. `backend/processors/shared.py`
   - `build_schedule_index()` - –≥–∏–±–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥
   - `parse_date_label_ru()` - –±–æ–ª—å—à–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤
   - `parse_time_from_str()` - Excel —á–∏—Å–ª–∞
   - `DEFAULTS` - –Ω–æ–≤—ã–µ –ø–æ—Ä–æ–≥–∏

2. `backend/processors/processor_rus.py`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –°—á—ë—Ç—á–∏–∫–∏ matched/unmatched

3. `backend/main.py`
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

4. `frontend/index.html`
   - –ù–æ–≤—ã–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–≤

---

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞–ª–∏—Å—å - –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ø—Ä–∏—à–ª–∏—Ç–µ –ª–æ–≥–∏.

